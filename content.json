{"meta":{"title":"JT","subtitle":"桀士","description":"这是一个懒人的网站","author":"Jackie Tang(唐浩桀)","url":"https://tanghaojie.github.io","root":"/"},"pages":[{"title":"about","date":"2018-09-30T09:25:30.000Z","updated":"2019-10-11T07:00:53.111Z","comments":true,"path":"about/index.html","permalink":"https://tanghaojie.github.io/about/index.html","excerpt":"","text":"document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });"},{"title":"contact","date":"2018-09-30T09:25:30.000Z","updated":"2019-10-11T07:01:24.899Z","comments":true,"path":"contact/index.html","permalink":"https://tanghaojie.github.io/contact/index.html","excerpt":"","text":"document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });"},{"title":"categories","date":"2018-09-30T09:25:30.000Z","updated":"2019-10-11T06:59:13.783Z","comments":true,"path":"categories/index.html","permalink":"https://tanghaojie.github.io/categories/index.html","excerpt":"","text":"document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });"},{"title":"friends","date":"2018-12-12T13:25:30.000Z","updated":"2019-10-11T07:01:39.596Z","comments":true,"path":"friends/index.html","permalink":"https://tanghaojie.github.io/friends/index.html","excerpt":"","text":"document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });"},{"title":"tags","date":"2018-09-30T10:23:38.000Z","updated":"2019-10-11T07:00:25.097Z","comments":true,"path":"tags/index.html","permalink":"https://tanghaojie.github.io/tags/index.html","excerpt":"","text":"document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });"}],"posts":[{"title":"Postgis和EntityFrameworkCore的关系映射，几何字段映射","slug":"entityframeworkcorewithpostgis","date":"2019-12-12T06:02:03.000Z","updated":"2019-12-12T08:47:14.215Z","comments":true,"path":"2019/12/12/entityframeworkcorewithpostgis/","link":"","permalink":"https://tanghaojie.github.io/2019/12/12/entityframeworkcorewithpostgis/","excerpt":"","text":"这篇文章主要讨论Code First模式，其他模式我不怎么用的，不敢保证 现在搞开发数据库操作基本上都用Orm了吧，但是我们搞GIS的，因为涉及到空间几何字段、空间拓扑运算操作的情况，很多时候传统的Orm就解决不了了，所以很多时候要么就直接用odbc原生Sql操作了；或者是业务部分EF+空间几何Sql这么来操作。这两个方案实现起来确实没什么问题，但前者用起来实在麻烦，很多简单的东西就搞复杂了，要么统一封装一下的话就又回到Orm的路子上；后者是最灵活的一种方案了，任何需求都可以用这个办法来解决，但问题就是整个软件的框架会显得很混乱，新人来了经常问为啥要这样搞，思维切换起来很麻烦，如果要改需求还涉及到空间几何的话，那只能打一架好了… 之前的DotnetFramework+Npgsql+EF是不支持使用PostGIS扩展的，官方一直也没明确表态后续规划什么的，直到最近在github上看到开发者说以后应该不会支持了，会把重心放到EF Core上。因此，想要直接映射几何字段几乎变成了不可能的事情。 网上有用SharpMap做映射的解决方案，但是我一直没有测试成功过官方的数据类型映射表里面也写了System.Data.Spatial.DbGeometry可以映射到Geometry类型。这个能在CodeFirst下识别，但生成的字段类型并不是Geometry，而是Byte[]，我也不知道哪错了，诶 直到最近我打算把平台切换到.NetCore，然后去研究了一下，整个人就豁然开朗了啊。1.微软官方明确表态实现几何类型的字段。2.Npgsql的Core版本确实在实现Postgis的东西，而且进度神速。那么，就用呗~ 依赖很简单，就两个包： 1.Npgsql.EntityFrameworkCore.PostgreSQL 2.Npgsql.EntityFrameworkCore.PostgreSQL.NetTopologySuite然后是配置，首先数据库里面要启用Postgis，简单：Create Extension Postgis;EFCore框架： dbContextOptions.UseNpgsql(connectionString, o => o.UseNetTopologySuite()); //这在哪自己找一下 //这在你的DbContext里面 protected override void OnModelCreating(ModelBuilder builder) { builder.HasPostgresExtension(\"postgis\"); //启用postgis扩展，需要手动写扩展名也是有原因的哦 } 齐活了，就这么简单。使用的话就很简单了： using NetTopologySuite.Geometries; public class TestGeometry{ [Column(TypeName = \"geometry (MultiLineString)\")] //可以指定类型、维度、坐标系 public MultiLineString Geom { get; set; } } 有了这个后续的操作就简单多了： Geom.Area //面积 Geom.AsBinary() //转wkb Geom.AsText() //同ToString()，转wkt ... ... 就不一一列举了，官方文档很全面的。 * 补充一下其他的坑吧，转 .Net Core以后，Gdal会成为一个很大的问题，这个需要好好的评估一下，Gdal目前还没有官方做Core的适配，这个影响挺大的。当然Gdal的功能也有相应各个独立的库能替换的，但始终不会像Gdal这么得心应手，一定要注意评估这一点！！！ * 版权声明：除非注明，本博文章均为原创，转载请以链接形式标明本文地址。 document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });","categories":[],"tags":[{"name":"gis","slug":"gis","permalink":"https://tanghaojie.github.io/tags/gis/"},{"name":"entityframework","slug":"entityframework","permalink":"https://tanghaojie.github.io/tags/entityframework/"},{"name":".net core","slug":"net-core","permalink":"https://tanghaojie.github.io/tags/net-core/"},{"name":"postgis","slug":"postgis","permalink":"https://tanghaojie.github.io/tags/postgis/"}],"author":null},{"title":"网站收录","slug":"website","date":"2019-10-12T08:22:48.000Z","updated":"2019-10-12T08:29:21.598Z","comments":true,"path":"2019/10/12/website/","link":"","permalink":"https://tanghaojie.github.io/2019/10/12/website/","excerpt":"","text":"Google探索实验室 document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });","categories":[{"name":"website","slug":"website","permalink":"https://tanghaojie.github.io/categories/website/"}],"tags":[{"name":"website","slug":"website","permalink":"https://tanghaojie.github.io/tags/website/"}],"author":null},{"title":"地理信息相关标准","slug":"gisstandard","date":"2019-10-12T07:58:36.000Z","updated":"2019-10-12T08:22:01.342Z","comments":true,"path":"2019/10/12/gisstandard/","link":"","permalink":"https://tanghaojie.github.io/2019/10/12/gisstandard/","excerpt":"","text":"OGC 开放地理空间信息联盟(Open Geospatial Consortium),是一个非盈利的国际标准组织，它制定了数据和服务的一系列标准，GIS厂商按照这个标准进行开发可保证空间数据的互操作。 Spatial reference 坐标系统收录、查询、上传、教育。 GDal GDAL(Geospatial Data Abstraction Library)是一个在X/MIT许可协议下的开源栅格空间数据转换库。它利用抽象数据模型来表达所支持的各种文件格式。它还有一系列命令行工具来进行数据转换和处理。OGR是GDAL项目的一个分支，功能与GDAL类似，只不过它提供对矢量数据的支持。 epsg 全球坐标系统 document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });","categories":[{"name":"gis","slug":"gis","permalink":"https://tanghaojie.github.io/categories/gis/"},{"name":"tips","slug":"gis/tips","permalink":"https://tanghaojie.github.io/categories/gis/tips/"},{"name":"website","slug":"gis/tips/website","permalink":"https://tanghaojie.github.io/categories/gis/tips/website/"}],"tags":[{"name":"tips","slug":"tips","permalink":"https://tanghaojie.github.io/tags/tips/"},{"name":"gis","slug":"gis","permalink":"https://tanghaojie.github.io/tags/gis/"},{"name":"website","slug":"website","permalink":"https://tanghaojie.github.io/tags/website/"}],"author":null},{"title":"地理地图数据提供网站","slug":"gisdatawebsites","date":"2019-10-12T07:51:21.000Z","updated":"2019-10-12T08:12:45.278Z","comments":true,"path":"2019/10/12/gisdatawebsites/","link":"","permalink":"https://tanghaojie.github.io/2019/10/12/gisdatawebsites/","excerpt":"","text":"OSGeo中国 开放地理空间信息科学：技术、数据、知识共享。 spatial hadoop 一个为空间数据设计的map reduce框架，有很多超大的数据集提供下载。 全国地理信息资源目录服务 国家基础地理信息中心提供的资源查询和下载服务。 document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });","categories":[{"name":"gis","slug":"gis","permalink":"https://tanghaojie.github.io/categories/gis/"},{"name":"tips","slug":"gis/tips","permalink":"https://tanghaojie.github.io/categories/gis/tips/"},{"name":"website","slug":"gis/tips/website","permalink":"https://tanghaojie.github.io/categories/gis/tips/website/"},{"name":"data","slug":"gis/tips/website/data","permalink":"https://tanghaojie.github.io/categories/gis/tips/website/data/"}],"tags":[{"name":"tips","slug":"tips","permalink":"https://tanghaojie.github.io/tags/tips/"},{"name":"gis","slug":"gis","permalink":"https://tanghaojie.github.io/tags/gis/"},{"name":"website","slug":"website","permalink":"https://tanghaojie.github.io/tags/website/"},{"name":"data","slug":"data","permalink":"https://tanghaojie.github.io/tags/data/"}],"author":null},{"title":"一些好玩的地理网站","slug":"gisForFunWebsites","date":"2019-10-12T06:57:09.000Z","updated":"2019-10-12T07:55:16.022Z","comments":true,"path":"2019/10/12/gisForFunWebsites/","link":"","permalink":"https://tanghaojie.github.io/2019/10/12/gisForFunWebsites/","excerpt":"","text":"Open Street Map 人人都可编辑的世界地图，一个网上地图协作计划的产物。 Land Lines Google Creative Lab 提交的一个 Chrome Experiments 项目，基于深度学习。 GeoGuessr 这是一个真实的「情景判断游戏」。开局就是随便把玩家落在 Google 街景中的某一处，你可以在街景地图中一路游走，然后根据周遭信息，判断出身处何处。 The WebGL Globe The WebGL Globe 是一个使数据地理可视化的平台。利用这个项目提供的开源代码，我们可以制作属于自己的数据地球。在项目网站上有不少网友提交的实验，根据人口变化、火山活动、各地维基百科篇目等方方面面的数据产生不同的可视化地球。 Ghost Map Ghost Map收录了各个城市的街道路线，将其隐藏在黑暗中。通过移动鼠标，光亮像细流入川一般流淌到附近街道上，灯火明亮，车水马龙，勾勒出这座城市的建筑与街道规划。当鼠标指针停止移动，万物歇息，一切又沉入黑暗。 SNAZZY MAPS 在线Google Maps配图。自带多种风格自由选择，而且都可以自定义。 Pixel Map 在线像素地图生成。 地图慧 在线地图制作，上传自己的数据，可以做热力图、流向图等等各种专题地图。 stamen 地图与制图、数据可视化。 Map Box 在线地图制图。 Map Stack 使设计地图免费,简单,有趣。 CAD Mapper cad su 等格式的模型下载。 发现中国 中国历史地图、古地图。 document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });","categories":[{"name":"gis","slug":"gis","permalink":"https://tanghaojie.github.io/categories/gis/"},{"name":"tips","slug":"gis/tips","permalink":"https://tanghaojie.github.io/categories/gis/tips/"},{"name":"website","slug":"gis/tips/website","permalink":"https://tanghaojie.github.io/categories/gis/tips/website/"}],"tags":[{"name":"tips","slug":"tips","permalink":"https://tanghaojie.github.io/tags/tips/"},{"name":"gis","slug":"gis","permalink":"https://tanghaojie.github.io/tags/gis/"},{"name":"website","slug":"website","permalink":"https://tanghaojie.github.io/tags/website/"},{"name":"fun","slug":"fun","permalink":"https://tanghaojie.github.io/tags/fun/"}],"author":null},{"title":"News","slug":"News","date":"2019-10-11T10:07:56.000Z","updated":"2019-10-12T08:36:12.940Z","comments":true,"path":"2019/10/11/News/","link":"","permalink":"https://tanghaojie.github.io/2019/10/11/News/","excerpt":"","text":"var x = 0; var y=1; 版权声明： 除非注明，本博文章均为原创，转载请以链接形式标明本文地址。 document.querySelectorAll('.github-emoji') .forEach(el => { if (!el.dataset.src) { return; } const img = document.createElement('img'); img.style = 'display:none !important;'; img.src = el.dataset.src; img.addEventListener('error', () => { img.remove(); el.style.color = 'inherit'; el.style.backgroundImage = 'none'; el.style.background = 'none'; }); img.addEventListener('load', () => { img.remove(); }); document.body.appendChild(img); });","categories":[],"tags":[],"author":"qqq"}]}